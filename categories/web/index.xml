<?xml version="1.0" encoding="utf-8" standalone="yes" ?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>Hello World Everything</title>
    <link>http://helloworldeverything.com/categories/web/index.xml</link>
    <description>Recent content on Hello World Everything</description>
    <generator>Hugo -- gohugo.io</generator>
    <language>en-us</language>
    <atom:link href="http://helloworldeverything.com/categories/web/index.xml" rel="self" type="application/rss+xml" />
    
    <item>
      <title>Step by step automatization with gulp</title>
      <link>http://helloworldeverything.com/2016/10/step-by-step-automatization-with-gulp/</link>
      <pubDate>Mon, 17 Oct 2016 18:11:44 -0400</pubDate>
      
      <guid>http://helloworldeverything.com/2016/10/step-by-step-automatization-with-gulp/</guid>
      <description>&lt;p&gt;Hands-on, multi-step exercise to discover gulp. How to automate multiple aspect of a static web page using gulp.&lt;/p&gt;

&lt;p&gt;&lt;/p&gt;

&lt;h2 id=&#34;overview&#34;&gt;Overview&lt;/h2&gt;

&lt;p&gt;Simple step-by-step to automate the process of a static web page with gulp.&lt;/p&gt;

&lt;h3 id=&#34;goal-of-this-post&#34;&gt;Goal of this post&lt;/h3&gt;

&lt;p&gt;Often after reading a let&amp;rsquo;s get started about a tech, I find my self not sure where to start applying what I learned.
So here is something to get your teeth start on!&lt;/p&gt;

&lt;h4 id=&#34;set-up-todo&#34;&gt;Set-up (todo)&lt;/h4&gt;

&lt;p&gt;Just an other javascript-package&lt;/p&gt;

&lt;ol&gt;
&lt;li&gt;Download this [source code]()&lt;/li&gt;
&lt;li&gt;Install gulp-cli globally&lt;br /&gt;&lt;/li&gt;
&lt;/ol&gt;

&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;npm install gulpjs/gulp-cli -g
&lt;/code&gt;&lt;/pre&gt;

&lt;ol&gt;
&lt;li&gt;In the repository install all npm module&lt;br /&gt;&lt;/li&gt;
&lt;/ol&gt;

&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;npm install 
&lt;/code&gt;&lt;/pre&gt;

&lt;h2 id=&#34;learning-project&#34;&gt;Learning-project&lt;/h2&gt;

&lt;p&gt;We (you and I) will build a simple project to show some useful capacity of gulp and its pluggins.
For some parts I will write every steps and other parts I will give directive for you to try.
At the end of everystep, I will provided a link to the code source of how I implemented it.&lt;/p&gt;

&lt;p&gt;What the project will do:&lt;br /&gt;
* Compile sass into css and minify them
* Minify and concat javascript file
* Live-reload: when we will change a html, css or js files the browser will automaticly reload and show the changes&lt;/p&gt;

&lt;h3 id=&#34;1-simply-copying-file&#34;&gt;1. Simply copying file&lt;/h3&gt;

&lt;p&gt;Using your knowledge to setup and and how implement simple task and watch, implements a gulpfile able to:&lt;br /&gt;
* Copying javascript from src/js -&amp;gt; build/js
* Copying images from src/img -&amp;gt; build/img
* On &amp;ldquo;gulp watch&amp;rdquo;, watcher should copy files when one is updated or a newer one is add
* On &amp;ldquo;gulp build&amp;rdquo;, should clean build/ then copy js and images&lt;/p&gt;

&lt;p&gt;&lt;a href=&#34;https://github.com/PrincessMadMath/hwe_gulp-introduction/tree/1_Copying&#34;&gt;My solution here (todo)&lt;/a&gt;&lt;/p&gt;

&lt;h3 id=&#34;2-minify-everything&#34;&gt;2. Minify everything!&lt;/h3&gt;

&lt;p&gt;Ok now you are a pro of moving files and watch some. Now we want to minify everything so it can be production ready.
Your job (if you accept it) is to meet the following criteria:
* Uglify then concat all javascript files
* Compress imagemin&lt;/p&gt;

&lt;p&gt;(todo: change)&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-javascript&#34;&gt;var gulp = require(&#39;gulp&#39;);
var concat = require(&#39;gulp-concat&#39;);
var uglify = require(&#39;gulp-uglify&#39;);
var imagemin = require(&#39;gulp-imagemin&#39;);
var del = require(&#39;del&#39;);

/* Defines globs to target specic files type */
var paths = {
  scripts: [&#39;src/js/**/*.js&#39;, &#39;!src/external/**/*.js&#39;],
  images: &#39;src/img/**/*&#39;
};
 
/* Register some tasks to expose to the cli */
gulp.task(&#39;build&#39;, gulp.series(
                      clean,
                      gulp.parallel(scripts, images)
                    ));
gulp.task(clean);
gulp.task(watch);
 
// The default task (called when you run `gulp` from cli) 
// Will build then watch for changes
gulp.task(&#39;default&#39;, gulp.series(&#39;build&#39;, watch));
 
 
/* Define our tasks using plain functions */
 
// Will delete the directory name build
function clean() {
  // Return a promise: (gulp required that the function return a promise, a stream or alternatively take a call back and call it)
  return del([&#39;build&#39;]);
}
 
// Take all images find in paths.images, minify them and save each of them in &amp;quot;build/img&amp;quot; (initial one doesn&#39;t change)
function images() {
  return gulp.src(paths.images)
    // imagemin is the module required at the beginning of the files, some module can take option
    .pipe(imagemin({optimizationLevel: 5}))
    .pipe(gulp.dest(&#39;build/img&#39;));
}
 
// Minify all JavaScript (except vendor scripts) and save the concatanate result in &amp;quot;build/js&amp;quot;
function scripts() {
  return gulp.src(paths.scripts)
    .pipe(uglify())
    .pipe(concat(&#39;all.min.js&#39;))
    .pipe(gulp.dest(&#39;build/js&#39;));
}
 
// Rerun the task when a file changes 
function watch() {
  gulp.watch(paths.scripts, scripts);
  gulp.watch(paths.images, images);
}

&lt;/code&gt;&lt;/pre&gt;

&lt;h3 id=&#34;3-small-improvement-and-changes&#34;&gt;3. Small improvement and changes&lt;/h3&gt;

&lt;p&gt;You may have notice that we do a lots of unecessary work about images: 1 image change/was added -&amp;gt; re-optimize everything!&lt;br /&gt;
We can use the gulp-cache pluggin to solve this problem: now check this &lt;a href=&#34;https://www.npmjs.com/package/gulp-cached/&#34;&gt;pluggin&lt;/a&gt; and implement it!&lt;/p&gt;

&lt;p&gt;Also you may have heard about sass, scrap the css and now use sass!&lt;/p&gt;

&lt;p&gt;&lt;a href=&#34;#&#34;&gt;My solution&lt;/a&gt; (update)&lt;/p&gt;

&lt;h3 id=&#34;4-live-reload&#34;&gt;4. Live-reload&lt;/h3&gt;

&lt;p&gt;We have almost a complete automatic process, we just want to stop hitting refresh when we make change. We want gulp to update that automatically for us.
We are in luck there is a useful module compatible with gulp for that: &lt;a href=&#34;https://www.browsersync.io/docs/gulp&#34;&gt;Browsersync&lt;/a&gt;.
I found it harder to implement this one, so I will go step by step.&lt;/p&gt;</description>
    </item>
    
    <item>
      <title>Gulp starter pack</title>
      <link>http://helloworldeverything.com/2016/10/gulp-starter-pack/</link>
      <pubDate>Fri, 14 Oct 2016 00:00:00 +0000</pubDate>
      
      <guid>http://helloworldeverything.com/2016/10/gulp-starter-pack/</guid>
      <description>&lt;p&gt;Simple starter pack for a static web site using the task-runner gulp (with focus on good practice). Use lots of sweet gulp plugin to make the development easier.&lt;/p&gt;

&lt;p&gt;&lt;/p&gt;

&lt;h1 id=&#34;overview&#34;&gt;Overview&lt;/h1&gt;

&lt;p&gt;In the series of creating a starter pack for a static web site.&lt;/p&gt;

&lt;!-- toc --&gt;

&lt;h2 id=&#34;goal-of-this-post&#34;&gt;Goal of this post&lt;/h2&gt;

&lt;p&gt;Here a list of what I hope you will be able to do after reading this article:&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;Explain why task runners are useful&lt;/li&gt;
&lt;li&gt;Understand core concept of Gulp 4.^&lt;/li&gt;
&lt;li&gt;Understand the starter project using gulp&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&#34;problem-gulp-is-tacking&#34;&gt;Problem Gulp is tacking&lt;/h2&gt;

&lt;h1 id=&#34;important-concept&#34;&gt;Important concept&lt;/h1&gt;

&lt;p&gt;Word to understand&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;cli:&lt;/li&gt;
&lt;li&gt;command line interface&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Set-up&lt;/p&gt;

&lt;p&gt;The easiest set-up instruction is found on the &lt;a href=&#34;https://github.com/gulpjs/gulp/blob/master/docs/getting-started.md&#34;&gt;official documentation&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;But because I used Gulp 4 and it is not released you need to replace&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;npm install --save-dev gulp 
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;by&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;npm install gulpjs/gulp.git#4.0  --save-dev 
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Otherwise a good introduction between the difference of gulp 3 and gulp 4, can be found in this &lt;a href=&#34;https://www.joezimjs.com/javascript/complete-guide-upgrading-gulp-4/&#34;&gt;guide&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&#34;https://github.com/PrincessMadMath/hwe_gulp-introduction/tree/1_Copying&#34;&gt;Source code&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Let&amp;rsquo;s take this following example and analyze it lines by lines:&lt;/p&gt;

&lt;p&gt;gulpfile.js:&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-javascript&#34;&gt;
/* 1: Import required modules for our task: all gulp-plugin necessary will be added here */ 
var gulp = require(&#39;gulp&#39;);

/* 2: Defines globs to target specific files type */ 
var paths = {   scripts: [&#39;src/js/**/*.js&#39;, &#39;!src/external/**/*.js&#39;], };

/****** Register some tasks to expose to the cli or other tasks ******/

// 3-1: We can call this task writing:
gulp build gulp.task(&#39;build&#39;,  scripts);

// 3-2: We can call using: 
gulp watch gulp.task(watch);

// 3-3: The default task, we can call using: 
gulp gulp.task(&#39;default&#39;, gulp.series(&#39;build&#39;, watch));

/******  Define our tasks using plain functions (available in Gulp 4.0) ******/

// 5: Copying all JavaScript (except vendor scripts) into &amp;quot;build/js&amp;quot; 
function scripts() {   
    return gulp.src(paths.scripts)     .pipe(gulp.dest(&#39;build/js&#39;));
}

// 6: Rerun the task when a file changes  
function watch() {   
    gulp.watch(paths.scripts, scripts);
}
&lt;/code&gt;&lt;/pre&gt;

&lt;h2 id=&#34;1-import&#34;&gt;1. Import&lt;/h2&gt;

&lt;p&gt;Working with gulp implies using many plugins: one to minify, another to compile sass and so on. To be able to use them we need to import them in the gulpfile.&lt;/p&gt;

&lt;p&gt;Here it my current workflow to use a new plugin.&lt;br /&gt;
1. Know what I want
2. Find a plugin that does what I want (using the &lt;a href=&#34;http://gulpjs.com/plugins/&#34;&gt;official plugin registry&lt;/a&gt; or any search engine)
3. Install the plugins to the dev dependencies (production doesn&amp;rsquo;t need to perform gulp task)&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;$ npm install [pluginName] --save-dev 
&lt;/code&gt;&lt;/pre&gt;

&lt;ol&gt;
&lt;li&gt;Add it in the gulpfile.js&lt;/li&gt;
&lt;/ol&gt;

&lt;pre&gt;&lt;code class=&#34;language-javascript&#34;&gt;var relevantName = require(&amp;quot;pluginName&amp;quot;);
&lt;/code&gt;&lt;/pre&gt;

&lt;h2 id=&#34;2-node-glob-why-and-how&#34;&gt;2. Node Glob: why and How&lt;/h2&gt;

&lt;p&gt;As you know by now, gulp is all about taking files and do some work with it. So, it is important to have an easy way to specify which files we want to operate on.
Here come glob, a matching pattern makes for files and easier to use than regex.&lt;/p&gt;

&lt;p&gt;When globbing we pass an array of patterns, which you should know:&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;Name wildcard (&lt;em&gt;): i.e : &amp;ldquo;&lt;/em&gt;.scss&amp;rdquo; any file ending with .scss&lt;/li&gt;
&lt;li&gt;Folder wildcard (&lt;strong&gt;): i.e : &amp;ldquo;src/&lt;/strong&gt;/*.css&amp;rdquo;: File in any subfolder inside src ending with .css&lt;/li&gt;
&lt;li&gt;Exclusion (!):  Could target a repo (&amp;ldquo;!vendor/&amp;rdquo;) or a specific file (&amp;ldquo;!.config&amp;rdquo;)&lt;/li&gt;
&lt;li&gt;Combine pattern (+(|)): i.e: Could be use to find any style file (&amp;rdquo;*.+(scss|css))&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Glob used in the starter project:&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-javascript&#34;&gt;html: [&#39;**/*.html&#39;],   
sass: [&#39;scss/**/*.scss&#39;],   
css : [&#39;css/**/*.css&#39;],   
js: [&#39;js/**/*.js&#39;],   
images: [&#39;img/**/*&#39;], 
&lt;/code&gt;&lt;/pre&gt;

&lt;h2 id=&#34;3-tasks&#34;&gt;3. Tasks&lt;/h2&gt;

&lt;blockquote&gt;
&lt;p&gt;FMORR: So now I know that Gulp is a task runner. Can you tell me more about those task!&lt;/p&gt;
&lt;/blockquote&gt;

&lt;h3 id=&#34;3-1-running-tasks&#34;&gt;3.1 Running Tasks&lt;/h3&gt;

&lt;blockquote&gt;
&lt;p&gt;FMORR: So tell me, how can I execute?&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;There is multiple way to execute a task. First they should be available in the gulpfile.js (the name of the file is important and should be in the repo where you use the CLI).&lt;/p&gt;

&lt;p&gt;As we saw in the example above there are 3 ways to declare a task:&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-javascript&#34;&gt;/****** Register some tasks to expose to the cli ******/

// 1: Explicitly declare the name
gulp.task(&#39;build&#39;,  scripts);

// 2: Implicitly use the function name 
gulp.task(watch);

// 3: &amp;quot;default&amp;quot; is a reserve keyword to declare the default task 
gulp.task(&#39;default&#39;, gulp.series(&#39;build&#39;, watch));
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Running #1:&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt; gulp build 
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Running #2:&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;gulp watch 
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Running #3:&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;gulp 
&lt;/code&gt;&lt;/pre&gt;

&lt;blockquote&gt;
&lt;p&gt;FMORR: What about using the implicit naming and a task sequence?&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;Well, you can&amp;rsquo;t and anyway it would result in a mess!&lt;/p&gt;

&lt;blockquote&gt;
&lt;p&gt;FMORR: How can I see which task is available&lt;/p&gt;
&lt;/blockquote&gt;

&lt;ul&gt;
&lt;li&gt;Read the gulpfile.js and find the task declaration&lt;/li&gt;
&lt;li&gt;If using gulp 4.0: you can use the following build-in command to list all the tasks and their composition (the blue-green name is task that you can call) ~~~Io $ gulp &amp;ndash;tasks ~~~&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&#34;3-2-tasks-sequence&#34;&gt;3.2 Tasks sequence&lt;/h3&gt;

&lt;blockquote&gt;
&lt;p&gt;FMORR: I like having decoupled code. Is it possible to create small independent function and group them together?&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;Well, yes, it would be a poor task runner otherwise! Gulp 4.0 allows to create sequence of tasks and you can define which task execute in series and which one in parallel.&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-javascript&#34;&gt;// We use gulp.series: because we don&#39;t want to start the build before the pre-build is completed 
gulp.task(&#39;compile&#39;, gulp.series(&#39;build:assets&#39;, &#39;build&#39;));

// We use a composition of series and parallel because we first want to delete the assets folder, 
// then we can create the new one. And every asset type can be built independently 
gulp.task(&#39;build:assets&#39;, gulp.series(   
    cleanAsset,    
    gulp.parallel(copyHtml, copyScript, copyCss, copyImages, compileSass) ));

// Same explication as above 
gulp.task(&#39;build&#39;, gulp.series(   
    cleanBuild,   
    gulp.parallel(buildHtml, buildScript, buildCss, buildImages) ));
&lt;/code&gt;&lt;/pre&gt;

&lt;blockquote&gt;
&lt;p&gt;FMORR: What happens if an error occurs in a task in series&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;The task stop and the none of the following is executed.&lt;/p&gt;

&lt;h3 id=&#34;3-3-task-implementation&#34;&gt;3.3 Task implementation&lt;/h3&gt;

&lt;p&gt;The normal implementation of a task consists of selecting some files using globs, do some work with them, and write the resulting files at the target location.&lt;/p&gt;

&lt;h2 id=&#34;4-watch&#34;&gt;4. Watch&lt;/h2&gt;

&lt;p&gt;A watcher is something that will execute tasks when certain event occurs and will continue to do so unless the watcher is stopped (ctrl+c) or an error occurs.&lt;/p&gt;

&lt;h1 id=&#34;gulp-starter-pack&#34;&gt;Gulp starter pack&lt;/h1&gt;

&lt;p&gt;Knowing all we know now, I decide to look into bit more into good practices with gulp so I can create a starter pack that can boost the start of your/my future static web site.&lt;/p&gt;

&lt;p&gt;&lt;a href=&#34;https://github.com/PrincessMadMath/helloworld-gulp-starter&#34;&gt;Source Code&lt;/a&gt;&lt;/p&gt;

&lt;h2 id=&#34;plugins&#34;&gt;Plugins&lt;/h2&gt;

&lt;p&gt;Task we want to perform
* Linting: ensure that everybody uses the same convention
** How enforce before committing/pushing?
* Minify and concat files
** Have better performance
* Autoprefixer&lt;br /&gt;
** Make cleaner style sheet: does not need to add vendor prefix&lt;/p&gt;

&lt;h2 id=&#34;config-file-explication&#34;&gt;Config file explication&lt;/h2&gt;

&lt;p&gt;In this &lt;a href=&#34;https://www.freshconsulting.com/how-to-organize-your-gulp-js-development-builds-for-multiple-environments/&#34;&gt;article&lt;/a&gt;, they talk about using a config files to remove the responsibility of specifying globs, plugin options,&amp;hellip; in the tasks files. It also allows to see everything in one place, easier modification and to reuse tasks for different environments.&lt;/p&gt;

&lt;p&gt;config.js:&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-javascript&#34;&gt;/*************** Load utility plugin to make the config files work ***************/

// Contain function to merge object
var _ = require(&#39;lodash&#39;);
// Be able to get CLI command parameters (for --env)
var gutil = require(&#39;gulp-util&#39;)

/*************** Path ***************/

// All tasks reference path here: make it easier to modify them
var paths = {
    src: &amp;quot;src/&amp;quot;,
    // Warning: changing this name require to add it the .gitignore  
    temp: &amp;quot;.temp/&amp;quot;,
    // Changing the dist folder name also required change in .gitignore and the npm deploy scripts
    dist: &amp;quot;build/&amp;quot;,
    glob: {
        html: [&#39;**/*.html&#39;],
        sass: [&#39;scss/**/*.scss&#39;],
        css: [&#39;css/**/*.css&#39;],
        js: [&#39;js/**/*.js&#39;],
        images: [&#39;img/**/*&#39;],
        assets: [&#39;assets/**/*&#39;]
    },
    dest: {
        html: &#39;&#39;,
        css: &#39;css/&#39;,
        sass: &#39;scss/&#39;,
        js: &#39;js/&#39;,
        images: &#39;img/&#39;,
        assets: &#39;assets/&#39;
    },
}

// Function to prefix a parent directory to each elements in an array of globs: 
//    -&amp;gt; return an array of globs 
// i.e: I want each css files in the src directory: prefixGlob(paths.src, paths.glob.css) 
// Todo: this should but not calculated at runtime...
function prefixGlob(prefix, glob) {
    return glob.map(function (el) {
        return prefix + el;
    })
}

/*************** Little explication ***************

For the next part, it will be split in the different available environment.

The default value will be used for properties that were not overridden. 

**************************************************/


/*************** Constants ***************/

// Currently I don&#39;t use constants but just to know it is possible 
var constants = {
    default: {
        placeHolderConstant: &#39;&#39;
    },
    development: {
        placeHolderConstant: &#39;dev&#39;
    },
    production: {
        placeHolderConstant: &#39;prod&#39;
    }
};



/*************** Plugin toggling ***************/

// Declare which plugins to run for each environment // The cleanest way is to set to false in default and enable them after
var run = {
    default: {
        js: {
            uglify: false
        },
        css: {
            cssnano: false,
            autoprefixer: true,
        },
        html: {
            useref: false
        }
    },

    development: {
        js: {
            uglify: false
        },
        css: {
            cssnano: false
        }
    },

    production: {
        js: {
            uglify: true
        },
        css: {
            cssnano: true
        },
        html: {
            useref: true
        }
    }
};


/*************** Plugin options ***************/

// Declare pluggins option
var plugin = {
    default: {
        js: {
            uglify: {
                mangle: true
            }
        },
        css: {
            autoprefixer: {
                browsers: [&#39;last 2 versions&#39;],
            }
        },
        lint: {
            eslint: {
                configFile: &amp;quot;.eslintrc&amp;quot;,
                fix: true
            }
        }
    },

    development: {
        js: {
            uglify: {

                mangle: false
            }
        },
        lint: {
            eslint: {
                configFile: &amp;quot;.dev.eslintrc&amp;quot;,
            }
        }
    },

    production: {
        js: {
            uglify: {
                mangle: true
            }
        }
    }
};


/*************** Exports ***************/

// How to set : --env=[name]
var env = gutil.env.env || &#39;development&#39;;


// Merge: : set the options depending of the environment and using the default value if not specified
var runOpts = _.merge({}, run.default, run[env]);
var pluginOpts = _.merge({}, plugin.default, plugin[env]);
var constantsOpts = _.merge({}, constants.default, constants[env]);

// Make object available to use
module.exports.constants = constantsOpts;
module.exports.run = runOpts;
module.exports.plugin = pluginOpts;

module.exports.paths = paths;
module.exports.prefixGlob = prefixGlob;

&lt;/code&gt;&lt;/pre&gt;

&lt;h2 id=&#34;task-file-explication&#34;&gt;Task file explication&lt;/h2&gt;

&lt;p&gt;It was often recommended to split the tasks in multiple files to again, make things cleaner.&lt;/p&gt;

&lt;p&gt;In my case I split in the following files:
* build.js: Tasks to build the project: make-it browser-ready
* watcher.js: Tasks to start a auto-reload server: to use when developing
* lint.js: Tasks to lint files&lt;/p&gt;

&lt;p&gt;gulpfile.js:&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-javascript&#34;&gt;
var gulp = require(&#39;gulp&#39;);

// Plugin to support splitting gulp task in multiple files 
var requireDir = require(&#39;require-dir&#39;);

// If we want to use tasks declare in other files: this plugging enable forward-reference 
var fwdRef = require(&#39;undertaker-forward-reference&#39;);

// Start registry supporting forward-reference
gulp.registry(fwdRef());

// Load different tasks found in the files
requireDir(&#39;./gulp&#39;);
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;build.js&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;Todo: add schema of build pipeline (vertical (step-by-step) vs horizontal (update))&lt;/li&gt;
&lt;/ul&gt;

&lt;pre&gt;&lt;code class=&#34;language-javascript&#34;&gt;
var gulp = require(&#39;gulp&#39;);
var config = require(&#39;./config&#39;);

/*** html pluggins ***/
var useref = require(&amp;quot;gulp-useref&amp;quot;);

/*** js plugins ***/
var uglify = require(&#39;gulp-uglify&#39;);

/*** style plugins ***/
var sass = require(&#39;gulp-sass&#39;);
var cssnano = require(&#39;gulp-cssnano&#39;);
var autoprefixer = require(&#39;gulp-autoprefixer&#39;);


/*** image plugins ***/
var imagemin = require(&#39;gulp-imagemin&#39;);

/*** util plugins ***/
var del = require(&#39;del&#39;);
var gulpif = require(&#39;gulp-if&#39;);



/*************** Task definition ***************/

gulp.task(&#39;build:check&#39;, gulp.parallel(&#39;lint:js&#39;, &#39;lint:style&#39;));

// From superset files (sass, typescript (not implemented)) to files usable by the browser (css, plain js,...)
gulp.task(&#39;build:compile&#39;, gulp.series(
    cleanCompile,
    gulp.parallel(copyHtml, copyScript, copyCss, copyImages, compileSass)
));

// Different operation to do on basic files: minify, autoprefixer,...
gulp.task(&#39;build:build&#39;, gulp.series(
    cleanBuild,
    gulp.parallel(buildHtml, buildScript, buildCss, buildImages, copyAssets)
));

// Any task that need to be perform on &amp;quot;final&amp;quot; files
gulp.task(&#39;build:post&#39;, postBuildConcat);

/*** Tasks to build step-by-step ***/
gulp.task(&#39;build&#39;, gulp.series(&#39;build:check&#39;, &#39;build:compile&#39;, &#39;build:build&#39;, &#39;build:post&#39;));


gulp.task(&#39;clean&#39;, gulp.parallel(cleanCompile, cleanBuild));


/*** Tasks to update by type ***/
gulp.task(&#39;update:html&#39;, gulp.series(copyHtml, buildHtml, postBuildConcat));
gulp.task(&#39;update:css&#39;, gulp.series(copyCss, buildCss, postBuildConcat));
gulp.task(&#39;update:sass&#39;, gulp.series(compileSass, buildCss, postBuildConcat));
gulp.task(&#39;update:js&#39;, gulp.series(copyScript, buildScript, postBuildConcat));
gulp.task(&#39;update:image&#39;, gulp.series(copyImages, buildImages));
gulp.task(&#39;update:assets&#39;, copyAssets);


/*************** Utils function ***************/

function cleanCompile() {
    return del([config.paths.temp]);
}

function cleanBuild() {
    return del([config.paths.dist]);
}

/*************** Compile function ***************/

function copyHtml() {
    var glob = config.prefixGlob(config.paths.src, config.paths.glob.html);
    var dest = config.paths.temp + config.paths.dest.html;

    return gulp.src(glob)
        .pipe(gulp.dest(dest));
}

function copyScript() {
    var glob = config.prefixGlob(config.paths.src, config.paths.glob.js);
    var dest = config.paths.temp + config.paths.dest.js;

    return gulp.src(glob)
        .pipe(gulp.dest(dest));
}

function copyCss() {
    var glob = config.prefixGlob(config.paths.src, config.paths.glob.css);
    var dest = config.paths.temp + config.paths.dest.css;

    return gulp.src(glob)
        .pipe(gulp.dest(dest));
}

function copyImages() {
    var glob = config.prefixGlob(config.paths.src, config.paths.glob.images);
    var dest = config.paths.temp + config.paths.dest.images;

    return gulp.src(glob)
        .pipe(gulp.dest(dest));
}

function compileSass() {
    var glob = config.prefixGlob(config.paths.src, config.paths.glob.sass);
    var dest = config.paths.temp + config.paths.dest.css;

    return gulp.src(glob)
        .pipe(sass())
        .pipe(gulp.dest(dest));
}


/*************** Build functions (make ready for production) ***************/

function buildHtml() {
    var glob = config.prefixGlob(config.paths.temp, config.paths.glob.html);
    var dest = config.paths.dist + config.paths.dest.html;

    return gulp.src(glob)
        .pipe(gulp.dest(dest));
}

// Only take from .temp and minify
function buildCss() {
    var glob = config.prefixGlob(config.paths.temp, config.paths.glob.css);
    var dest = config.paths.dist + config.paths.dest.css;

    return gulp.src(glob)
        .pipe(gulpif(config.run.css.autoprefixer, autoprefixer(config.plugin.css.autoprefixer)))
        .pipe(gulpif(config.run.css.cssnano, cssnano()))
        .pipe(gulp.dest(dest));
}

function buildImages() {
    var glob = config.prefixGlob(config.paths.temp, config.paths.glob.images);
    var dest = config.paths.dist + config.paths.dest.images;

    return gulp.src(glob)
        .pipe(imagemin({
            optimizationLevel: 5
        }))
        .pipe(gulp.dest(dest));
}

function buildScript() {
    var glob = config.prefixGlob(config.paths.temp, config.paths.glob.js);
    var dest = config.paths.dist + config.paths.dest.js;

    return gulp.src(glob)
        .pipe(gulpif(config.run.js.uglify, uglify(config.plugin.js.uglify)))
        .pipe(gulp.dest(dest));
}

function copyAssets() {
    var glob = config.prefixGlob(config.paths.src, config.paths.glob.assets);
    var dest = config.paths.dist + config.paths.dest.assets;

    return gulp.src(glob)
        .pipe(gulp.dest(dest));
}


/*************** Post-build task (final file modification) ***************/

// Because we concat files based on the declaration in the .html, we need to
// run the concat everytime one of the target files is update 
// (or else it is not in the concat version)
function postBuildConcat() {
    var glob = config.prefixGlob(config.paths.dist, config.paths.glob.html);
    var dest = config.paths.dist + config.paths.dest.html;

    return gulp.src(glob)
        .pipe(gulpif(config.run.html.useref, useref()))
        .pipe(gulp.dest(dest));
}

&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;watcher.js:&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-javascript&#34;&gt;var gulp = require(&#39;gulp&#39;);
var config = require(&#39;./config&#39;);

// Plugin to enable live-reload (https://www.browsersync.io/docs/gulp)
var browserSync = require(&#39;browser-sync&#39;).create();


/*************** Task definition ***************/
gulp.task(&#39;server&#39;, gulp.series(&#39;build&#39;, gulp.parallel(&#39;lint:watch&#39;, watchBuild, watchServer, startServer)));


/*************** Watcher functions (change -&amp;gt; build) ***************/

// When a modification is done in the src folder, update the build
function watchBuild() {
    var html_glob = config.prefixGlob(config.paths.src, config.paths.glob.html);
    var js_glob = config.prefixGlob(config.paths.src, config.paths.glob.js);
    var image_glob = config.prefixGlob(config.paths.src, config.paths.glob.images);
    var sass_glob = config.prefixGlob(config.paths.src, config.paths.glob.sass);
    var css_glob = config.prefixGlob(config.paths.src, config.paths.glob.css);
    var assets_glob = config.prefixGlob(config.paths.src, config.paths.glob.assets);

    gulp.watch(html_glob, gulp.series(&#39;update:html&#39;));
    gulp.watch(js_glob, gulp.series(&#39;update:js&#39;));
    gulp.watch(image_glob, gulp.series(&#39;update:image&#39;));
    gulp.watch(sass_glob, gulp.series(&#39;update:sass&#39;));
    gulp.watch(css_glob, gulp.series(&#39;update:css&#39;));
    gulp.watch(assets_glob, gulp.series(&#39;update:assets&#39;));
}

// When change occurs in /build we want to notify the server (reload or inject)
function watchServer() {
    var html_glob = config.prefixGlob(config.paths.dist, config.paths.glob.html);
    var js_glob = config.prefixGlob(config.paths.dist, config.paths.glob.js);
    var image_glob = config.prefixGlob(config.paths.dist, config.paths.glob.images);
    var css_glob = config.prefixGlob(config.paths.dist, config.paths.glob.css);
    var assets_glob = config.prefixGlob(config.paths.dist, config.paths.glob.assets);

    gulp.watch(html_glob, reload);
    gulp.watch(js_glob, reload);
    gulp.watch(image_glob, reload);
    gulp.watch(css_glob, injectCss);
    gulp.watch(assets_glob, reload);
}

/*************** Browsersync helper function ***************/

function startServer() {
    browserSync.init({
        server: {
            baseDir: config.paths.dist
        }
    });
}

// Inject css files (instead of reloading)
function injectCss() {
    var css_glob = config.prefixGlob(config.paths.dist, config.paths.glob.css);

    return gulp.src(css_glob)
        .pipe(browserSync.stream());
}

function reload(done) {
    browserSync.reload();
    done();
}

&lt;/code&gt;&lt;/pre&gt;

&lt;h1 id=&#34;annex-a-questions-i-asked-myself&#34;&gt;Annex A: Questions I asked myself.&lt;/h1&gt;

&lt;h2 id=&#34;how-does-it-work-behind-the-scenes&#34;&gt;How does it work behind the scenes?&lt;/h2&gt;

&lt;p&gt;Each plugin manipulate virtual file that are streamed with node&amp;rsquo;s stream (all manipulation is done in memoery: there is no intermediate files). You can use streamed files (access by chunks) or a buffer (if the whole file is needed before starting task).&lt;/p&gt;

&lt;p&gt;I created 2 minimal plugin that lower every character. Minimal because no check nor error handling.&lt;/p&gt;

&lt;p&gt;Using buffer:&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-javascript&#34;&gt;var through = require(&#39;through2&#39;);

function transformText(file) {
var content = file.contents.toString(&#39;utf8&#39;);
return content.toLowerCase();
}

// plugin level function: will deals which each files function toLowerPlugin(){

function handleFile(file, enc, callback){

//  if (file.isBuffer())          var output = transformText(file);

file.contents = new Buffer(output, &#39;utf8&#39;);

// Notify stream engine that we are done with this file         callback(null, file);
}

return  through.obj(handleFile);
}

// Make it available to use module.exports = toLowerPlugin;
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Using stream:&lt;/p&gt;

&lt;p&gt;They also recommend supporting streaming, but most of the example I found doesn&amp;rsquo;t support them. Maybe I will give an example later.&lt;/p&gt;

&lt;p&gt;&lt;a href=&#34;https://medium.com/@webprolific/getting-gulpy-a2010c13d3d5#.dosj4tpx9&#34;&gt;Good documentation&lt;/a&gt;&lt;/p&gt;

&lt;h2 id=&#34;what-are-the-alternatives-of-gulp&#34;&gt;What are the alternatives of gulp?&lt;/h2&gt;

&lt;p&gt;First you can look at other task runners:&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;Grunt -&amp;gt; getting their powerfulness from all the available plugins, seem more complicated to setup/use than gulp&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Then you can ask yourself if we can do things differently: here come bundlers.&lt;/p&gt;

&lt;h2 id=&#34;i-saw-there-is-multiple-way-we-can-use-watchers-can-you-tell-me-more-about-them&#34;&gt;I saw there is multiple way we can use watchers, can you tell me more about them.&lt;/h2&gt;

&lt;p&gt;(todo)&lt;/p&gt;

&lt;h2 id=&#34;what-about-npm-packages-and-modules&#34;&gt;What about npm, packages and modules?&lt;/h2&gt;

&lt;p&gt;The purpose of npm is to shared small block of code solving a problem (called package).&lt;/p&gt;

&lt;blockquote&gt;
&lt;p&gt;FMORR: OK but what consists of a package?_&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;Well, it is simple a directory where you find a package.json file.&lt;/p&gt;

&lt;blockquote&gt;
&lt;p&gt;Ohhh and what can it do?_&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;It can add new available command for the command line (like gulp) or export method that you can use in you js file.&lt;/p&gt;

&lt;blockquote&gt;
&lt;p&gt;FMORR: OK last question! What is the difference between a module and a package?_&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;Everything within require() is a module. A module is a single js file exposing multiple function that we can use (look for the &lt;strong&gt;exports&lt;/strong&gt; keyword). A package can contain multiple modules and depend on other packages and contains an entry point (often index.js) that is use in the require().&lt;/p&gt;

&lt;h1 id=&#34;annex-b-sources&#34;&gt;Annex B: Sources&lt;/h1&gt;

&lt;p&gt;&lt;a href=&#34;https://github.com/gulpjs/gulp&#34;&gt;Source code of Gulp&lt;/a&gt;&lt;br /&gt;
&lt;a href=&#34;https://www.npmjs.com/package/gulp-4.0.build&#34;&gt;Official code sample&lt;/a&gt;&lt;br /&gt;
&lt;a href=&#34;https://github.com/gulpjs/gulp/blob/master/docs/README.md&#34;&gt;Official documentation&lt;/a&gt;&lt;/p&gt;</description>
    </item>
    
  </channel>
</rss>